# ============================
# SYNC Pick & Place Loop (NO tp_popup, NO movel)
# - movej만 사용 (q1/q2)
# - 1번 위치에서 집고, 2번 위치에서 놓기
# - 3회 반복
# ============================

# 관절 목표 (deg)
q1 = [24.73, 26.23, 109.51, -151.30, 51.40, 162.57]      # Pick 위치
q2 = [-33.49, 12.52, 85.29, 0.03, 82.14, -32.99]         # Place 위치

VJ = 70
AJ = 70

DWELL_MOVE = 0.2      # 이동 후 안정화 대기
DWELL_GRIP = 1.0      # 그리퍼 동작 대기
N_REPEAT = 3

def open_gripper():
    set_digital_output(2, ON)
    wait(DWELL_GRIP)
    set_digital_output(2, OFF)

def close_gripper():
    set_digital_output(1, ON)
    wait(DWELL_GRIP)
    set_digital_output(1, OFF)

def main():
    # 시작: 안전하게 오픈 상태로 가정
    open_gripper()

    # 처음 픽 위치로 이동
    movej(q1, v=VJ, a=AJ)
    wait(DWELL_MOVE)

    k = 0
    while k < N_REPEAT:
        # 1) Pick at q1
        close_gripper()
        wait(0.1)

        # 2) Go to place q2
        movej(q2, v=VJ, a=AJ)
        wait(DWELL_MOVE)

        # 3) Place at q2
        open_gripper()
        wait(0.1)

        # 4) Return to pick q1 (다음 반복 준비)
        movej(q1, v=VJ, a=AJ)
        wait(DWELL_MOVE)

        k = k + 1

main()
