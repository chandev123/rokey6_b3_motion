# -------------------------
# Shelf3 orientation constraint
#  - Tool direction in XZ plane (perpendicular to Y axis)
#  - Angle to XY plane: 30~40 deg
# -------------------------
S3_TILT_TO_XY_DEG = 35.0  # 30~40 사이로 조절
S3_TILT_SIGN = +1.0       # +1: +X쪽으로 기울임 / -1: -X쪽으로 기울임

def s3_fixed_work_pose_tilt():
    x0, y0, z0, A0, B0, C0 = S3_BASE

    # XY평면과 각 = S3_TILT_TO_XY_DEG 가 되도록 피치 크기 설정
    # (툴 Z축이 XZ평면에 있고, 수평면과 theta 각이 되게 만들기)
    B_mag = 90.0 - S3_TILT_TO_XY_DEG   # 예: 35 -> 55
    A = 0.0
    B = S3_TILT_SIGN * B_mag
    C = 0.0

    return posx(x0, y0, z0, A, B, C)

def s3_fixed_app_pose_tilt():
    x0, y0, z0, A0, B0, C0 = S3_BASE

    B_mag = 90.0 - S3_TILT_TO_XY_DEG
    A = 0.0
    B = S3_TILT_SIGN * B_mag
    C = 0.0

    return posx(x0, y0, z0 + Z_UP, A, B, C)

def movel_place_s3_fixed_tilt():
    movel(s3_fixed_app_pose_tilt(),  v=V_FAST, a=A_FAST)
    movel(s3_fixed_work_pose_tilt(), v=V_SLOW, a=A_SLOW)
    wait(0.2)

    open_gripper()
    wait(0.2)

    movel(s3_fixed_app_pose_tilt(),  v=V_FAST, a=A_FAST)
    wait(0.1)
